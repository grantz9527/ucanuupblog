<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
	<title>顾文斌的博客</title>
	<!-- 移动设备优先
	为了让 Bootstrap 开发的网站对移动设备友好，确保适当的绘制和触屏缩放，需要在网页的 head 之中添加 viewport meta 标签，如下所示： -->
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" type="text/css" th:href="@{/resources/awesome/font-awesome-4.7.0/css/font-awesome.min.css}"></link>
    <link rel="stylesheet" type="text/css" th:href="@{/resources/bootstrap/bootstrap-4.1.3-dist/css/bootstrap.min.css}"></link>
    <link th:href="@{/resources/wangEditor/release/wangEditor.min.css}">
    <script type="text/javascript" th:src="@{/resources/jquery/jquery-3.3.1.min.js}"></script>
     <script type="text/javascript" th:src="@{/resources/wangEditor/release/wangEditor.min.js}"></script>
    <script type="text/javascript" th:src="@{/resources/bootstrap/bootstrap-4.1.3-dist/js/bootstrap.min.js}"></script>
    <script type="text/javascript" th:src="@{/resources/vue/vue.min.js}"></script>
</head>
<body style="background-color: #f4f8fb" >
	<div class="container-fluid" style="background-color: black">
		<div class="container" style="background-image: url('/resources/blog/img/nav2.jpg');height: 300px;">
		</div>
	</div>
	<div class="container" style="margin-top: -90px"  id="bbs">
		<div class="container" style="height: 30px;">
			<header >
			<style>
				header a {
					margin-left: 10px;
					color: white;
				}
				header a:hover{
					background-color:black;
			    }
			    div article:hover{
					 transform: rotate(360deg) scale(1.02);
					 -webkit-box-shadow: 5px 5px 5px 3px #eee;
			  	}
			  	div a {
			  		margin-left: 10px;
					color: white;
			  	}
			  	div a:hover{
					background-color:gray;
			    }
			</style>
				<div style="float: left">
					<a th:href="@{/home}" >首页</a>
					<a th:href="@{/article/index}" >分类</a>
					<a th:href="@{/bbs/index}" >留言</a>
					<a th:href="@{/about/index}" >关于我</a>
				</div>
				<div style="float: right">
					<a href="https://github.com/grantz9527" class="rounded" target="_blank"><i class="fa fa-qq fa-lg"></i></a>
					<a href="https://github.com/grantz9527" class="rounded" target="_blank"><i class="fa fa-wechat fa-lg"></i></a>
					<a href="https://github.com/grantz9527" class="rounded" target="_blank"><i class="fa fa-github fa-lg"></i></a>
					<a data-toggle="modal" data-target="#myModal" class="rounded" target="_blank"><i class="fa fa-gear fa-lg"></i></a>
				</div>
			</header>
		</div>
		<div class="container rounded" style="background-color: #f4f8fb;padding: 40px;">
		<div  class="container">
		
			<div  class="row  rounded" style="border:1px solid #eee;background-color: #eee;padding:20px; margin-top:10px;"  v-for="(msg,index) in page.content">
				<div class="col-sm-2 rounded" style="padding:20px;background-color: white">
					<div  style="padding:20px;">
						<div><center><img  v-bind:src="msg.headpic" width="50px;" height="50px;"/></center></div>
						<div style="word-wrap:break-word;font-size:14px"><center>{{msg.userName}}</center></div>
						<div style="word-wrap:break-word;color: #adadad;font-size:12px"><center>2018-10-17</center></div>
					</div>
				</div>
				<div class="col-sm-10" >
					<div class="rounded" style="padding:20px;background-color:white">
						<p style="word-wrap:break-word"  v-html="msg.content"></p>
						<p style="word-wrap:break-word;color: #adadad;font-size:12px"  > 
						<a v-on:click="addPriase" style="cursor:pointer;">赞    <i class="fa fa-thumbs-o-up">({{msg.priase}})</i> </a>
						<a v-on:click="addPriase" style="cursor:pointer;">评论<i class="fa fa-comment-o">({{msg.priase}})</i> </a>
						
						</p>
						<div  class="row" v-for="(son,index) in msg.son">
							<div class="col-sm-2" >
								<div style="padding:20px;">
									<div><center>{{son.userName}}</center></div>
									<div><center><img  v-bind:src="son.headpic" width="50%" height="50px;"/></center></div>
								</div>
							</div>
							<div class="col-sm-10" >
								<div style="padding:20px;">
									<p >{{son.call}}</p>
									<p style="word-wrap:break-word">{{son.content}}</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
			
		</div>
		
		<!--  -->
		<div class="container" style="margin-top:10px;background-color: #f4f8fb;padding: 40px;margin-bottom: 20px;">
			<div id="editor">
			
		    </div>
		    <div><button v-on:click="addLeavingMsg">提交</button>  <button>重置</button></div>
		</div>
	</div>
	
	<footer class="container-fluid" style="background-color: black;padding: 20px;color: white">
		<div class="container">
			<p><small>Gu WenBin  版权所有</small></p>
			<p>
				depend on：
				<a href="http://www.runoob.com/bootstrap4/bootstrap4-tutorial.html" target="_blank">bootstrap</a>
				<a href="http://fontawesome.dashgame.com/" target="_blank">fontawesome</a>
				<a href="http://fontawesome.dashgame.com/" target="_blank">eclipse</a>
				<a href="http://fontawesome.dashgame.com/" target="_blank">java</a>
				<a href="http://fontawesome.dashgame.com/" target="_blank">spring</a>
			</p>
			<p>
				我的信息：
				<a href="https://github.com/grantz9527" target="_blank"><i class="fa fa-github fa-lg"></i></a>
				<a href="https://github.com/grantz9527" target="_blank"><i class="fa fa-qq fa-lg"></i></a>
				<a data-toggle="modal" data-target="#myModal" target="_blank"><i class="fa fa-wechat fa-lg"></i></a>
			</p>
		</div>
	</footer>
</body>
<script type="text/javascript" th:inline="javascript">
	var vm = new Vue({
	  el: '#bbs',
	  data: {
		  	 hello : 'hello',
	    	 page : {
	    		 content:[],
	    		 pageNo : 0 ,
	    		 pageSize: 10 ,
	    		 total : 10
	    	 }
	  },
	  mounted:function(){
		  this.fetchData();
	  },
	  methods : {
		  fetchData: function(){
		    	var _this = this;
		    	$.ajax({
	 		        type : "get",
	 		        url : [[@{/bbs/list}]],
	 		        data:{ 
	 		        	pageNo : _this.page.pageNo, 
	 		        	pagesize : _this.page.pagesize 
	 		        },
	 		        dataType:"json",
	 		        success: function(data) {
	 		        	_this.$set(vm,"page", data);
	 		        }
	 		    });
		    },
		    addLeavingMsg : function(){
		    	$.ajax({
	 		        type : "get",
	 		        url : [[@{/bbs/addLeavingMsg}]],
	 		        data:{ 
	 		       		content : getContent(),
	 		       		commentType: 'BBS',
	 		        },
	 		        dataType:"json",
	 		        success: function(data) {
	 		        	if(data.status){
	 		        		vm.fetchData();
	 		        	}else{
	 		        		alert(data.msg);
	 		        	}
	 		        }
	 		    });
		    },
		    addPriase : function(id){
		    	alert(id);
		    },
		    addComment : function(id){
		    	alert(id);
		    }
	  }
	})

	var E = window.wangEditor
	var editor = new E('#editor')
	// 或者 var editor = new E( document.getElementById('editor') )
	editor.create()
	
	function getContent(){
		return editor.txt.html();
	}
	
</script>
</html>